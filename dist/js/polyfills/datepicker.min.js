/*!
 * Web Experience Toolkit (WET) / Boîte à outils de l'expérience Web (BOEW)
 * wet-boew.github.io/wet-boew/License-en.html / wet-boew.github.io/wet-boew/Licence-fr.html
 * v4.0.0-b2-development - 2013-12-18
 *
 */!function(a,b,c,d){"use strict";var e,f,g,h="wb-date",i="input[type=date]",j=h+"-inited",k="wb-init."+h,l="setfocus.wb",m=new Date,n=m.getMonth(),o=m.getFullYear(),p="YYYY-MM-DD",q=!1,r=d.doc,s=function(b){var c=b.target,h=c.id;if(b.currentTarget===c&&-1===c.className.indexOf(j)){if(d.remove(i),c.className+=" "+j,-1!==c.className.indexOf("picker-field"))return;f||(e=d.i18n,f={show:e("date-show")+e("space"),hide:e("date-hide"),selected:e("date-sel"),close:e("overlay-close")+e("space")+e("esc-key")}),c.className+=" picker-field",g||(g=a("<div id='wb-picker' class='picker-overlay' role='dialog' aria-hidden='true'></div>"),a("<button type='button' class='picker-close mfp-close overlay-close' title='"+f.close+"'>×<span class='wb-inv'> "+f.close+"</span></button>").appendTo(g).on("click",function(a){var b=a.which;b&&1!==b||w(g.attr("aria-controls"))}),g.find("a").attr("tabindex","-1"),a("body > main > div").after(g)),h&&t(h),q=!0}},t=function(b){var c=a("label").filter("[for='"+b+"']").clone().find(".datepicker-format").remove().end().text(),d=f.show+c,e="<button id='"+b+"-picker-toggle' class='picker-toggle' href='javascript:;' title='"+d+"'><span class='glyphicon glyphicon-calendar'></span><span class='wb-inv'>"+d+"</span></button>";a("#"+b).after(e),g.slideUp(0)},u=function(a,b,e,f,g){var h,i,j,k,m,n,o=c.getElementById(a),p=o.getAttribute("min"),q=o.getAttribute("max"),r=d.date.fromDateISO,s=f.length,t=g?g-1:0;for(p=r(p?p:"1800-01-01"),j=p.getDate()-1,q=r(q?q:"2100-01-01"),k=q.getDate(),h=b===p.getFullYear()&&e===p.getMonth(),i=b===q.getFullYear()&&e===q.getMonth(),m=0;m!==s;m+=1)(!h&&!i||h&&m>=j||i&&k>m)&&(n=f[m],n.innerHTML="<a href='javascript:;' tabindex='"+(m===t?"0":"-1")+"'>"+n.getElementsByTagName("div")[0].innerHTML+"</a>");g&&f.eq(g-1).find("a").trigger(l)},v=function(b,d,e,g){var h,i;a(g).removeClass("picker-sel").find(".picker-sel-text").detach(),h=c.getElementById(b).value;try{""!==h&&(i=new Date(h),i.getUTCFullYear()===d&&i.getUTCMonth()===e&&a(g[i.getUTCDate()-1]).addClass("picker-sel").children("a").attr("aria-selected","true").append("<span class='wb-inv picker-sel-text'> ["+f.selected+"]</span>"))}catch(j){}},w=function(b){var e=c.getElementById(b),h=a(e),i=e.getAttribute("min"),j=e.getAttribute("max"),k=d.date.fromDateISO,m=k(e.value);i||(i="1800-01-01"),j||(j="2100-01-01"),g.attr({"aria-labelledby":b+"-picker-toggle","aria-controls":b}),r.trigger("create.wb-cal",["wb-picker",o,n,!0,i,j]),h.after(g),"false"!==g.attr("aria-hidden")?(x(b),g.slideDown("fast").attr("aria-hidden","false"),a("#"+b+"-picker-toggle").children("a").children("span").text(f.hide),null!==m?r.trigger("setFocus.wb-cal",["wb-picker",o,n,k(i),k(j),m.setDate(m.getDate()+1)]):a("#wb-picker").trigger(l)):(y(b),h.trigger(l))},x=function(b){var c,d,e=a(".picker-field").get(),f=e.length;for(c=0;c!==f;c+=1)d=e[c].id,d!==b&&y(d)},y=function(b){var c=a("#"+b+"-picker-toggle"),d=a("label[for="+b+"]").text();g.slideUp("fast").attr("aria-hidden","true").trigger("hideGoToFrm.wb-cal"),c.children("a").children("span").text(f.show+d)},z=function(a,b,c,e){var f=d.string.pad;return e.replace("DD",f(c,2)).replace("D",c).replace("MM",f(b,2)).replace("M",b).replace("YYYY",a).replace("YY",a.toString().substr(2,2))};r.on("timerpoke.wb "+k,i,s),r.on("click vclick touchstart focusin","body",function(b){var d,e=b.which;return!q||e&&1!==e||(d=c.getElementById("wb-picker"),"false"!==d.getAttribute("aria-hidden")||b.target.id===d.id||a.contains(d,b.target))?void 0:(y(d.getAttribute("aria-controls")),!1)}),r.on("keydown displayed.wb-cal","#wb-picker",function(b,c,d,e,f){var g=a(this),h=b.type,i=b.which,j=g.attr("aria-controls");switch(h){case"keydown":27===i&&(x(),a("#"+j).trigger(l));break;case"displayed":u(j,c,d,e,f),v(j,c,d,e);break;case"click":case"vclick":case"touchstart":case"focusin":g.attr("aria-hidden")===!1&&(i&&1!==i||(b.stopPropagation?b.stopImmediatePropagation():b.cancelBubble=!0))}}),r.on("click",".picker-toggle",function(a){a.preventDefault();var b,c=a.which;return c&&1!==c?void 0:(b=this.id,w(b.substring(0,b.indexOf("-picker-toggle"))),!1)}),r.on("click",".cal-days a",function(b){var e,f,g,h,i,j,k=b.which;return k&&1!==k?void 0:(e=c.getElementById("wb-picker").getAttribute("aria-controls"),f=d.date.fromDateISO(this.getElementsByTagName("time")[0].getAttribute("datetime")),g=f.getFullYear(),h=f.getMonth(),i=f.getDate(),j=a("#"+e),j.val(z(g,h+1,i,p)),v(e,g,h,i),w(e),!1)}),d.add(i)}(jQuery,window,document,wb);